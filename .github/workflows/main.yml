name: Run SAT Scanner

on:
  schedule:
    # Daily post-market SAT scan (15:45 IST ≈ 10:15 UTC), Mon–Fri
    - cron: '15 10 * * 1-5'
    # Mid-week near-breakout logging (Wednesday 16:30 IST ≈ 11:00 UTC)
    - cron: '0 11 * * 3'
  workflow_dispatch:  # manual trigger if needed

jobs:
  run-script:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repo
      uses: actions/checkout@v3

    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'

    - name: Install dependencies
      run: |
        pip install pandas requests yfinance python-telegram-bot

    - name: Run SAT Scanner
      env:
        TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
        TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
      run: |
        python scanner.py --max-symbols 200  # scans all symbols
